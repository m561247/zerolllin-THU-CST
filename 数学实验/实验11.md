## 实验11 数据的统计与分析

张一可 2021010793 计15

### 实验目的

1. 掌握概率统计的基本概念及用 MATLAB 实现的方法
2. 练习用这些方法解决实际问题

### 实验10-5 炮弹问题

#### 问题分析与模型建立

与课上例子不同的是，当 $x, y$ 不独立时，不能只考虑 1/4 圆，而需要从整个圆所在区间 $[-100,100] \times [-100, 100]$ 内按照均匀分布随机取点，判断点是否落在圆 $\Omega$ 区域内，利用蒙特卡罗方法求解。

子弹落在位置 $(x,y)$ 的概率密度函数为：
$$
p(x,y) = \frac{1}{2\pi \sigma_1\sigma_2 \sqrt{1-r^2}}exp\{-\frac{1}{2(1-r^2)}[\frac{x^2}{\sigma_1^2}+\frac{y^2}{\sigma_1^2} - 2r\frac{xy}{\sigma_1\sigma_2}]\}
$$
取 $x_i, y_i$ 为 $[-100,100]$，$[-100,100]$ 上的均匀分布随机数，设共有 $m$ 个点是否落在圆内，根据均值估计法，子弹落在圆形区域 $\Omega$ 内的概率为：
$$
P=\int_{\Omega} f(x,y)dxdy \approx \frac{4a^2}{n}\sum_{k=1}^{m}f(x_k,y_k)
$$

#### 代码实现

编写 MATLAB 解题程序如下：

```
a=100;r=0.4;
s1=80;s2=50;
n=100000;m=0;z=0;
x=unifrnd(-100,100,1,n);
y=unifrnd(-100,100,1,n);
for i=1:n
	if x(i)^2+y(i)^2<=a^2
		u=exp(-0.5/(1-r^2)*(x(i)^2/s1^2+y(i)^2/s2^2-2*r*(x(i)*y(i))/(s1*s2)));
		z=z+u;
		m=m+1;
	end
end
P=4*a^2*z/(2*pi*s1*s2*sqrt(1-r^2)*n);
```

#### 实验结果与分析

运行4次程序，得到的结果分别为  P = 0.6980  P = 0.7005  P = 0.6990  P = 0.6987

因此可以得出结论，子弹落在圆形区域内的概率为 0.70 左右



### 实验10-7 报童问题

#### 问题分析与模型建立

修改例 6 中的报纸批发价 $a$ 为 $a(n) = A(1-\frac{n}{K})$ 后，得到收益 $V(n)$ 的值修改为：
$$
V(n) = \int_{0}^{n}[(b-A(1-\frac{n}{K}))x+(A(1-\frac{n}{K})-c)(n-x)]p(x) dx + \int_{n}^{\infin}(b-A(1-\frac{n}{K}))np(x)dx
$$
求导得：
$$
V^{'}(n) = \int_{0}^{n}(c+A(\frac{2n}{K}-1))p(x)dx + \int_{n}^{\infin}(b+A(\frac{2n}{K}-1))p(x)dx \\
V^{"}(n) = (c-b)p(x) + \frac{2A}{K}\int_{0}^{\infin}p(x)dx
$$
令 $V^{'}(n) = 0$，得：
$$
\int_{-\infin}^{n}p(x)dx = \frac{b-A(1-\frac{2n}{K})}{b-c}
$$
验证可得此时 $V^{"}(n)<0$，对于这一关于 $n$ 的 ODE 方程，可利用 MATLAB 的 fzero 求解，得到 $V(n)$ 取最小值时 $n$ 的取值。

#### 代码实现

MATLAB 解题代码如下：

```
b=0.5;c=0.35;
A=0.5;K=50000;
r=2000;s=50;
y=fzero(@(x)f(x,A,K,b,c,r,s),[200,3000]);

function y=f(x,A,K,b,c,r,s)
    q=(b-A*(1-2*x/K))/(b-c);
    y=norminv(q,r,s)-x;
end
```

#### 结果分析与讨论

解得 n = 1968，即报童每天购买 1968 张报纸时能够获得最大利润。



### 实验10-9 轧钢问题

#### 问题分析与模型建立

目标1的优化目标为最小化没跟钢材浪费长度的期望，即：
$$
V(m)=\int_{0}^{l}xp(x)dx + \int_{l}^{\infin}(x-l)p(x)dx
$$
目标2的优化目标为最小化每得到一根规定刚材浪费长度的期望，由于仅在 $x\ge l$ 时能够得到规定钢材，该优化目标可转化为：
$$
W(m) = \frac{V(m)}{\int_{l}^{\infin}p(x)dx}
$$
可以利用 MATLAB 的 fminbnd 工具求解这一约束优化问题

#### 代码实现

MATLAB 求解代码如下，针对目标1的求解代码为：

```
l=2;
s=0.2;
y=fminbnd(@(x)f(x,l,s),2,3);

function y=f(x,l,s)
    p=1-normcdf(l,x,s);
    y=x-l*p;
end
```

针对目标2的求解代码为：

```
l=2;
s=0.2;
y=fminbnd(@(x)f(x,l,s),2,3);

function y=f(x,l,s)
    p=1-normcdf(l,x,s);
    y=x-l*p;
    y=y/p;
end
```

#### 结果分析与讨论

解得目标 1 结果为 2.3327，目标 2 结果为 2.3562

即以 “每粗轧一根钢材的浪费最小” 为目标时，粗轧的钢材长度均值应该设为 2.3327 米，而以 “没得到一根规定长度钢材的浪费最小” 为目标时，粗轧的钢材长度均值应该设为 2.3562 米。



### 总结与收获

通过实验，我增强了自己分析具体概率统计问题，并利用 MATLAB 工具求解的能力。如何将复杂问题转换为常微分方程、非线性优化问题等来进行求解，对于分析解决实际问题十分重要。

#### 实验五

张一可 2021010793 计15

#### 5.3

##### 算法分析

将矩阵 $A$ 分解为 $A = D-L-U$，其中 $D$ 为对角阵，$L$ 为上三角阵，$U$ 为下三角阵。Jaccobi 迭代法的公式为
$$
Dx^{(k+1)} = (L+U)x^{(k)} + b \\
x^{(k+1)} = D^{-1}(L+U)x^{(k)} + D^{-1}b
$$
Gauss-Seideil 法的公式为：
$$
Dx^{(k+1)} = Lx^{(k+1)} + Ux^{(k)} + b \\
x^{(k+1)} = (D-L)^{-1}Ux^{(k)} + (D-L)^{-1}b
$$
给出的矩阵 $A$ 是严格对角占优的，即满足 $1\le i\le n$，$|a_{ii}| \ge \sum_{j\ne i} |a_{ij}|$，可知两种解法必然收敛。计算对应迭代形式中矩阵 $B$ 的谱半径或范数也可判断两种迭代法的收敛性。

通过设计程序进行循环迭代，我们可以计算迭代误差满足 $\Vert x^{(k+1)} - x^{(k)}\Vert \le 10^{-5}$ 时两种方法所需的迭代次数。

##### 计算程序

```matlab
n=20;
a0=sparse(1:n,1:n,3,n,n);
a1=sparse(2:n,1:n-1,-0.5,n,n);
a2=sparse(3:n,1:n-2,-0.25,n,n);
A=a0+a1+a1'+a2+a2';

k=1000; % 最大迭代次数
err=1e-5; % 允许误差精度
U=-triu(A,1);
L=-tril(A,-1);
D=diag(diag(A));
b=(1:20)';
x=(1:20)';
y=(1:20)';

% Jacobi迭代
B1=D\(L+U);
f1=D\b;

i=1; % 记录迭代次数
while 1
    x_last=x;
    x=B1*x+f1;
    if i>=k % 不收敛
        break
    end
    if norm(x_last-x)<err
        break
    end
    i=i+1;
end

% Gauss-Sebeil迭代
B2=(D-L)\U;
f2=(D-L)\b;

j=1; % 记录迭代次数
while 1
    y_last=y;
    y=B2*y+f2;
    if j>=k % 不收敛
        break
    end
    if norm(y_last-y)<err
        break
    end
    j=j+1;
end

i,j % 输出迭代次数
```

##### 计算结果

(1) 使用不同的 $b$ 和迭代初始值 $x^{(0)}$，迭代误差 $\Vert x^{(k+1)}-x^{(k)}\Vert \le 10^{-5}$ 时，Jaccobi 法收敛所需的迭代次数如下：

| 收敛所需的迭代次数       | $b=zeros(20, 1)$ | $b=ones(20, 1)$ | $b=(1:20)'$ |
| ------------------------ | ---------------- | --------------- | ----------- |
| $x^{(0)} = zeros(20, 1)$ | 1                | 18              | 21          |
| $x^{(0)} = ones(20, 1)$  | 19               | 17              | 21          |
| $x^{(0)} = (1:20)'$      | 22               | 22              | 20          |

Gauss-Seideil 法收敛所需的迭代次数如下：

| 收敛所需的迭代次数       | $b=zeros(20, 1)$ | $b=ones(20, 1)$ | $b=(1:20)'$ |
| ------------------------ | ---------------- | --------------- | ----------- |
| $x^{(0)} = zeros(20, 1)$ | 1                | 12              | 14          |
| $x^{(0)} = ones(20, 1)$  | 13               | 12              | 14          |
| $x^{(0)} = (1:20)'$      | 15               | 15              | 14          |

对比两种方法，可以看到 Gauss-Seideil 法收敛明显快于 Jaccobi 法。同时，迭代初始值 $x^{(0)}$ 越接近最终解时，所需的迭代次数越少。

(2) 选取 $b=zeros(20,1)$，$x^{(0)}=ones(20,1)$，Jaccobi 法所需的迭代次数如下：

| 主对角元 | 收敛所需的迭代次数 |
| -------- | ------------------ |
| 1        | 不收敛             |
| 2        | 41                 |
| 3        | 18                 |
| 5        | 11                 |
| 10       | 7                  |
| 30       | 5                  |

在主对角元为 1 时，$A$ 不是严格对角占优矩阵，计算可知其范数大于1，Jaccobi 法不收敛。同时，可以观察到随着对角元的增大，矩阵的对角占优程序增强，Jaccobi 法的收敛速度随之加快。

##### 结果分析与结论

根据以上实验结果，可以得到如下结论：

1. 对角占优矩阵使用 Jacobi 与 Gauss-Seidel 迭代法均能收敛
2. 相同条件下，Jacobi 方法收敛比 Gauss-Seidel 方法慢
3. 给定初始值越接近最终解，迭代次数越少
4. 对角占优矩阵的对角元优势越强，使用迭代法求解速度越快

#### 5.5

##### 算法设计

第 $j$ 个部门对第 $i$ 个部门的投入为表中第 $i$ 行第 $j$ 列的元素，设为 $x_{ij}$。设投入系数 $a_{ij}$ 表示部门 $j$ 对部门 $i$ 投入占其总投入的百分，即 $x_{ij}=a_{ij}x_j$ . 设第 $i$ 个部门的外部需求设为 $d_i$，产出为 $x_i$，则有：
$$
\sum_{j=1}^{n}x_{ij} = \sum_{j=1}^{n}a_{ij}x_j + d_i = x_i
$$
转化为矩阵形式即为：
$$
x = Ax+d\\
(I-A)x=d
$$
计算投入系数矩阵为：
$$
A= \begin{equation}
 \left[
 \begin{array}{ccc}
     0.15 & 0.1 & 0.2 \\
     0.3 & 0.05 & 0.3 \\
     0.2 & 0.3 & 0 
 \end{array}
 \right]        
 \end{equation}
$$
第一问中，根据题目中给出的不同的外部需求 $d$，计算 $x$ 即可。

第二问中，求 $(I-A)\Delta x = \Delta d$ ，同样带入 $\Delta d=1$ 求解 $\Delta x$ 即可。

##### 计算程序

```matlab
A=[0.15,0.1,0.2;0.3,0.05,0.3;0.2,0.3,0]; % 投入系数矩阵
d=[50,150,100]';
x=(eye(3)-A)\d;

d1=[1,1,1]';
x1=(eye(3)-A)\d1; % 这个错了，应该和例题一样（“分别”）
```

##### 计算结果

(1) 三个部门的总产出分别为 $139.3, \ 267.6, \ 208.1$ 亿元

(2) 三个部门的产出分别增加 $1.94, \ 2.32, \ 2.09$ 个单位

#### 5.8

##### 算法设计

对点 1 在水平和竖直方向上分别进行受力分析，得到：
$$
\frac{\sqrt{3}}{2}F_3+\frac{1}{2}F_1 = F \\
\frac{\sqrt{3}}{2}F_1 - \frac{1}{2} F_3 = 0
$$
对点 2 在水平和竖直方向上进行受力分析，得到：
$$
\frac{1}{2}F_1 - V_2 = 0 \\
\frac{\sqrt{3}}{2}F_1 - F_2 - H_2 = 0
$$
对点 3 在水平和竖直方向上进行受力分析，得到：
$$
\frac{1}{2}F_3 - F_2 = 0 \\
\frac{\sqrt{3}}{2}F_3 - V_3 = 0
$$
得到线性方程组：
$$
\begin{equation}
\left[
 \begin{array}{aaa}
     \frac{1}{2} & 0 & \frac{\sqrt{3}}{2} & 0 & 0 & 0  \\
     \frac{\sqrt{3}}{2} & 0 & -\frac{1}{2} & 0 & 0 & 0 \\ 
     \frac{1}{2} & 0 & 0 & 0 & -1 & 0 \\ 
     \frac{\sqrt{3}}{2} & -1 & 0 & -1 & 0 & 0 \\ 
     0 & -1 & \frac{1}{2} & 0 & 0 & 0 \\ 
     0 & 0 & \frac{\sqrt{3}}{2} & 0 & 0 & -1 
 \end{array}
 \right] 
 \left[
 \begin{array}{ccc}
     F_1 \\ F_2 \\ F_3 \\ H_2 \\ V_2 \\ V_3
 \end{array}
 \right]=
 \left[
 \begin{array}{ccc}
     F \\ 0 \\ 0 \\ 0 \\ 0 \\ 0
 \end{array}
 \right] 
 \end{equation}
$$
带入 $F$ 及 $\Delta F$ 解方程组即可得到各个力的大小。

##### 计算程序

```matlab
A=[0.5,0,sqrt(3)/2,0,0,0;
    sqrt(3)/2,0,-0.5,0,0,0;
    0.5,0,0,0,-1,0;
    sqrt(3)/2,-1,0,-1,0,0;
    0,-1,0.5,0,0,0;
    0,0,sqrt(3)/2,0,0,-1];
b=[100,0,0,0,0,0]';
x=A\b;
delta_b=[1,0,0,0,0,0]';
delta_x=A\delta_b;
```

##### 计算结果

得到外力 $F$ 为 100 kg 时各个力的大小为：
$$
F_1 = 50 \ kg, \ F_2 = 43.3 \ kg, \ F_3 = 86.6\ kg\\ \ H_2 = 0\ kg, \ V_2 = 25 \ kg, \ V_3 = 75\ kg
$$
外力变化 $\Delta F$ = 1 kg 时，解方程 $A \Delta x = \Delta b$ 得到各个力的变化值为：
$$
\Delta F_1 = 0.5 \ kg,\ \Delta F_2 = 0.433 \ kg,\ \Delta F_3 = 0.866\ kg\\ \Delta H_2 = 0\ kg,\ \Delta V_2 = 0.25 \ kg,\ \Delta V_3 = 0.75\ kg
$$

## 第8讲 互联网路由安全 & 第10讲 互联网流量分析与检测

1. **请简要描述RPKI的证书签发体系是怎样构成的**

   RPKI 数字证书系统遵循注册时的层次结构，自上而下包括 IANA，RIR，NIR，LIR，ISP 各级。

   RPKI 证书包含 CA 和 EE 证书两种，CA 证书用来担保 IP 和 AS 分配，EE 证书用于路由源授权。

   签发证书时，沿层次链逐级签发带有各级数字签名的数字证书，最终由 ISP 签发 ROA，完成 AS 和 IP 前缀的绑定。ROA 将某个 IP 地址授权给某个 AS，携带的信息包含正在为其创建 ROA 的网络、应该发起 BGP 宣告的 ASN，ROA 被授权可以宣告的最大前缀长等。

   验证证书时，需要沿证书链从各级 RIR 仓库同步证书及签名对象，逐级验证 ROA 有效性。

2. **流量检测算法设计目标应该包含什么？检测后的防御手段包含哪些方案？请各列举5条并简要分析**

   流量检测算法设计目标：
   
   1. **通用性**：检测多种攻击
   2. **泛化性**：检测未知攻击
   3. **鲁棒性**：检测攻击逃逸行为
   4. **加密流量**：检测加密攻击流量
   5. **高效性**：处理大规模流量
   6. **实时性**：快速输出检测结果
   
   流量检测的防御手段：
   
   1. **路由黑洞**：在邻近攻击者的位置丢弃向被保护目标发出的全部流量，即路由节点向攻击者隐蔽攻击目标。
   
      这种方案可以在进入受害者所在 AS 之前拦截攻击流量，可以通过 BGP 协议实现而不需要额外设计，同时需要的信息较少，只需要受害者的地址即可。但这种方法的灵活性差，会同时拦截向保护对象发出的正常流量。
   
   2. **IP 黑名单**：IP 黑名单是一个攻击者 IP 地址的集合，防御者认为来自黑名单中的 IP 地址的流量为恶意流量而进行屏蔽。
   
      这种方案可以直接部署在防火墙，并可以在短期内有效预防攻击。但该方案的灵活性较差，会同时拦截正常流量和恶意流量，并需要手动维护黑名单 IP 地址列表，人力资源开销大。
   
   3. **流量清洗中心**：在距离客户端较近的网络边缘处，部署一组拥有特征匹配功能的网络设备集群，对通过的流量进行流量特征匹配，拦截攻击流量，将正常流量返还给目的端。
   
      这种方案的优势为可以在距离边缘节点近的位置过滤流量，可以有效降低攻击流量在网络中的传播距离，并可以灵活按需配给。缺点为流量特征匹配实现难度大，需要消耗大量资源维护流量状态。
   
   4. **可编程交换机方案**：在可编程交换机上高效部署过滤规则，检测到攻击流量并加以限制。
   
      该方案防御方法灵活，并可以应对大规模恶意流量如 DDos 攻击。缺点为可编程数据面的资源存在限制，细粒度防御难以实现。
   
   5. **利用攻击流量特性进行防御**：利用DDoS流量的突发特性，仿照拥塞控制算法进行防御。
   
      该方案可以针对大规模恶意流量如 DDos 攻击进行防御。缺点为需要结合其他防御方式，识别不具有大量突发泛洪流量的其他恶意攻击并进行防御。


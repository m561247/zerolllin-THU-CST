## 第六章 操作系统安全

1. **请描述栈溢出攻击和堆溢出攻击的基本原理**

   栈溢出攻击：通过修改栈帧中的返回地址，实现进程控制流劫持，使攻击者可以越界访问

   堆溢出攻击：通过构造堆区重叠等方式恶意操纵堆管理数据结构，实现堆区的越界访问和恶意内存读写

2. **请简述面向返回地址编程(ROP)和全局偏置表劫持攻击(GOT Hijacking)的原理，并分析他们能否绕过以下三种内存防御机制，并简述原因：**

   **ROP** 的原理为利用程序文本段的合法指令片段重组得到恶意应用程序。这些指令片段以 ret 结尾，可以通过这些指令片段修改寄存器，将返回地址设为另一指令片段的起始地址，从而依次执行这些指令片段，实现进程控制流劫持。

   ROP 的返回地址均为程序文本段的合法地址，有执行权限，因此可以绕过 W^X 防御机制。

   ROP 可以绕过 ASLR 机制，因为目前 ASLR 随机性不强，并且依赖模块自身的支持。

   ROP 需要构造填充负载跳转到第一个 Gadget 的地址，因此不能绕过 Stack Canary 机制。

   **GOT Hijacking** 的原理为恶意篡改数据段的 GOT 表，GOT 表负责管理动态链接库函数的地址映射，GOT 表的修改可以使进程调用攻击者指定的库函数，实现控制流劫持。

   GOT 表位于数据段，有读写修改权限，并且装载共享库函数的页上有执行权限，因此 GOT Hijacking 可以绕过 W^X 保护机制。

   GOT Hijacking 可以绕过 ASLR 保护机制，因为 ASLR 无法随机化文本段的位置，攻击者仍然可以通过 PLT 表恶意读取 GOT 表项目，而后得到动态库当中函数的地址。

   GOT Hijacking 也需要依靠栈溢出攻击读取并修改 GOT 表项，因此不能绕过 Stack Canary 机制。

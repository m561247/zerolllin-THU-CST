### 基于固定规则

#### 利用固定规则对流量的负载进行匹配

缺点：

1. 依赖深度包检测技术，对加密流量不可用
2. 大量过滤规则消耗计算资源
3. 逃逸策略躲避检测
4. 人工设计的固定规则仅可针对已知流量进行过滤，无法应对未知攻击 (Zero-Day Attacks)

#### 基于机器学习的恶意流量识别

包括三个模块：1. 包解析  2. 流量特征抽取   3. 机器学习算法

相比于固定规则检测，其优势有：

1. 借助机器学习泛化性，检测未知攻击
2. 相比于固定规则方案检测准确度更高
3. 不依赖人力设定固定规则，低人工处理开销

### 基于统计特征

#### 基于包粒度的检测方法

包粒度的特征检测相比于与传统负载特征分析的**优点**在于：

1. 不依赖数据包负载信息：可以识别加密流量
2. 采用的统计信息可以对多种流量提取：实现通用检测，识别多种攻击
3. 流量不用维护流状态：一定程度降低了检测开销
4. 细粒度分析网络流量

包粒度特征检测仍然存在的**不足**：

1. 将数据包视为孤立个体，难以分析数据包之间的高层次的依赖关系
2. 逐个数据包分析的效率问题，通常离线运行或工作在低负载网络下
3. 鲁棒性不佳，操纵数据包当中字段可以完成逃逸攻击
4. 逐一分析每一个数据包带来显著的性能开销，无法适应快速增长的流量规模

#### 基于流粒度特征的检测方法

**为每一条流抽取一个特征向量**，作为机器学习的输入，分类每一条流是否为正常的数据包

流一般被定义为**具备相同五元组的数据包序列**，即具备相同：

源目的地址 + 源目的端口 + 传输层协议类型

流级别特征是最常见的一类特征，因为有较高的效率被广泛采用

1. **相比于包粒度特征的优势**：
   - 相比包级别特征考虑了数据包之间的关联关系，因而可以检测出更加复杂的攻击
   - 在没有专用硬件的条件下达到良好的效率，解决了性能开销的问题，距离大规模部署更近了一步
2. **相比于包粒度检测的劣势**：
   - 缺乏细粒度的分析，攻击者很容易逃逸检测
   - 大量维护大量流特征造成显著的性能开销
3. **两大类特殊的流粒度检测方法**：
   1. 对**加密恶意流量**的检测方法
   2. **可编程数据平面上**的检测方法

#### 可编程交换机方案

将**流级别特征抽取**或者**机器学习算法**全部或者部分的实现在可编程交换机上，例如 Intel Tofino 芯片，他们采用P4语言进行编程，可以达到**Tb级别的线速检测**

这些方法分为纯粹数据面方法，和数据面控制面混合方法

优势：

1. **高吞吐低延迟**，向着真实世界可用迈了一大步
2. 在高吞吐网络，例如广域网上完成检测，因此可以保护大量的合法用户

劣势：

1. 硬件资源限制导致可以实现的模型和特征十分有限，**检测精度**也存在折损

可编程网络设备上检测方法最大优势是：

**能在高吞吐网络下实现实时检测**

然而，其支持的模型和特征仍然十分有限：

1. 模型局限性：能在数据面部署的模型大多是树相关的模型，因为其很方便采用查表实现，虽然现有工作在尝试部署复杂模型
2. 特征局限性：能提取的特征相对简单，虽然其中已经设计了大量的近似计算
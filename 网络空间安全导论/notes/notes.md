### CH3 数据加密

#### 密码学简史

古典密码：置换 & 代换技术，密码安全性在于加密算法本身的安全性

近代密码（对称密码）：密码算法可以公开，密钥保密

缺陷：1. 密钥必须经过安全信道分配  2. 无法用于数字签名  3. 密钥管理复杂度为 $O(n^2)$

近代密码：基于数学函数而非代换和置换，使用两个密钥，对密钥分配、数字签名、认证有深远影响

#### 对称密码

对称密码的基本设计原则：扩散，扰乱

常用算法包括：DES，AES

#### 公钥密码



#### 摘要与签名



#### 密码分析技术



### CH4 隐私保护

#### 隐私保护技术初探

面向数据发布：数据匿名化，数据失真，数据加密

面向数据挖掘：关联规则的数据挖掘，变换/隐藏技术

#### 匿名化



#### 差分隐私



#### 同态加密



#### 安全多方计算



#### 联邦学习



### CH8 互联网路由安全

#### 层次化路由体系结构

位于网络层，选择转发分组的路径

自治域 AS：AS 内部运行 intra-AS 域内路由协议

域内路由协议：OSPF ，每个路由器维护链路状态数据库 OSDB，使用 Dijkstra 算法构造路由表

网关路由器：AS 之间运行 inter-AS 域间路由协议

域间路由协议：BGP，交换所有增量更新的路由信息

#### 路由安全问题

**OSPF 攻击**：攻击者伪装成合法的域内路由器，伪造 OSPF 协议的 LSA 报文广播出去，迷惑其他路由器路由表的计算

原合法路由器会采取 Fight-back 安全机制，纠正伪造报文

Periodic Injection 攻击：Fight back 报文的纠正需要与 LSA 报文间隔 5 秒

Disguised LSA 攻击：判别 LSA 报文是否相同时，主要依靠报文中的 Sequence Number，Checksum 和 Age 三个字段，攻击者预测报文中的这三个值，使路由器认为 fight back 纠正报文为重复报文

**BGP 路由劫持攻击**：攻击者宣告一个并不存在的 IP 地址前缀，进行虚假路由宣告

这个恶意宣告必须满足：宣告的 IP 地址更具体（子前缀劫持），或提供一条通往目标 IP 的更短路径

攻击者需要具有 AS 运行商权限

**BGP 路由泄露攻击**：超出路由传播范围的路由宣告

常见的路由商业关系：C2P，P2P，S2S

#### 路由源验证

BGP 缺陷：假设运营商都是可信的，缺乏内建安全机制

保障路由安全的措施：

1. **路由过滤**，防止意外或恶意的前缀声明

2. 保证全球互联网路由的稳定与一致性：**IRR 全球路由策略分布式数据库**

   IRR 对象：route/route6 指定 AS 的起源路由，aut-num 详细注册信息，inetnum/inetnum6 有关 IP 地址和 AS 号码等资源的信息，mnter 用于管理授权和认证

   缺陷：数据准确性，不完整，可维护性，缺乏验证

3. RPKI 数字证书系统

   ROA：某个 IP 地址所有者将 IP 地址授权给某个 AS，是经过加密签名的对象，包括正在为其创建 ROA 的网络、应该发起 BGP 宣告的 ASN，ROA 被授权可以宣告的最大前缀长等信息

   RPKI 证书：CA 证书用来担保 IP 和 AS 分配，EE 证书用于路由源授权

   - 将 IP 地址和 ASN 使用公钥绑定

   - 遵循注册时的层次结构，自上而下包括 IANA，RIR，NIR，LIR，ISP，
     - 逐级签发数字证书，ISP 签发 ROA，将 AS 和 IP 前缀绑定在一起
     - 沿证书链从各级 RIR 仓库同步证书及签名对象，逐级验证 ROA 有效性

   - 资源持有者的授权声明（ASN X 被授权使用我的前缀 Y，签名）

#### 路径验证



### CH10 流量分析技术

1. **攻击流量的检测和防御**：现代计算机病毒通常依赖网络流量进行传播，通过分析流量，有助于识别传播计算机病毒的恶意流量，拦截攻击流量并阻断攻击。
2. **流量特征隐私窃取**：同时，流量还包含用户加密后的隐私信息，需要防御攻击者通过流量分析，携带加密后的用户隐私信息的流量中窃取隐私。





### CH11 分布式系统安全





### CH12 应用安全

